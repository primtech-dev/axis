import{$ as t}from"./jquery-DxCMfk7S.js";import{i as p}from"./choices-helper-DdZc0wPI.js";import"./_commonjsHelpers-D6-XlEtG.js";import"./jquery-BQXThELV.js";import"./choices-BgrVbzTe.js";function a(n){window.toast&&typeof window.toast.error=="function"?window.toast.error(n):console.warn("Toast not available:",n)}function h(n){if(!n)return"";const r=n.toString().normalize("NFKD").replace(/[^\w\s-]/g,"").trim().replace(/\s+/g,"-").replace(/-+/g,"-").toUpperCase();return`${r.startsWith("KNC-")?"":"KNC-"}${r}`.substring(0,32)}function s(n){return n==null?!1:!isNaN(n)&&isFinite(n)}function d(n){if(!n)return!0;const r=n.trim();return/^[0-9+\-\s()]{4,20}$/.test(r)}t(function(){try{const e=document.querySelector('select[name="manager_admin_user_id"]');e&&p(e,{searchEnabled:!0,itemSelectText:"",shouldSort:!1,placeholderValue:"Pilih manager (opsional)",removeItems:!1,maxItemCount:1,allowHTML:!1})}catch(e){console.warn("Choices init failed:",e)}const n=t("#name"),r=t("#code");n.length&&r.length&&n.on("input",function(){const e=r.val();if(!e||e.trim()===""){const i=h(t(this).val());r.val(i)}}),t("#latitude, #longitude").on("blur",function(){const e=t(this).val().trim();e!==""&&(s(e)||(a("Latitude/Longitude harus berupa angka (contoh: -6.200000)."),t(this).val(""),t(this).focus()))}),t("#phone").on("blur",function(){const e=t(this).val().trim();e!==""&&(d(e)||(a("Format nomor telepon tidak valid. Gunakan angka dan simbol + - () jika perlu."),t(this).focus()))}),t("#branchForm").on("submit",function(e){const i=t("#code").val().trim(),f=t("#name").val().trim();if(!i)return e.preventDefault(),a("Kode cabang harus diisi."),t("#code").focus(),!1;if(!f)return e.preventDefault(),a("Nama cabang harus diisi."),t("#name").focus(),!1;const l=t("#latitude").val().trim(),u=t("#longitude").val().trim();if(l&&!s(l))return e.preventDefault(),a("Latitude harus berupa angka."),t("#latitude").focus(),!1;if(u&&!s(u))return e.preventDefault(),a("Longitude harus berupa angka."),t("#longitude").focus(),!1;const c=t("#phone").val().trim();if(c&&!d(c))return e.preventDefault(),a("Format nomor telepon tidak valid."),t("#phone").focus(),!1;const o=t(this).find('button[type="submit"]').first();o.prop("disabled",!0);const m=t(this).find('input[name="_method"][value="PUT"]').length>0?"Menyimpan perubahan...":"Membuat cabang...";return o.data("orig-html",o.html()),o.html(`<span class="spinner-border spinner-border-sm me-1" role="status" aria-hidden="true"></span> ${m}`),!0}),typeof window.serverValidationErrors<"u"&&Array.isArray(window.serverValidationErrors)&&window.serverValidationErrors.forEach(e=>a(e))});
