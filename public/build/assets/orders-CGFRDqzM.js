import{$ as c}from"./jquery-DxCMfk7S.js";import{D as f}from"./dataTables.bootstrap5-SLVZVhPx.js";import"./responsive.bootstrap5-CO5iH43l.js";import{s as m}from"./delete-modal-helper-Dt6JVILi.js";import{i as p}from"./tooltip-helper-B_gzMSQw.js";import"./_commonjsHelpers-D6-XlEtG.js";import"./jquery-BQXThELV.js";import"./bootstrap-BTbS0qBz.js";import"./index-BEKk9TLb.js";window.btnDeleteOrder=function(t,o){m({modalId:"deleteOrderModal",formId:"deleteOrderForm",itemNameId:"delete_order_title",id:t,name:o,route:window.orderRoutes.destroy})};window.openChangeStatusModal=function(t,o,e=""){try{const a=document.getElementById("changeStatusModal");if(!a){console.error("Modal changeStatusModal tidak ditemukan di DOM.");return}const l=document.getElementById("changeStatusOrderId"),u=document.getElementById("changeStatusOrderNo"),s=document.getElementById("changeStatusForm"),d=document.getElementById("status");if(l&&(l.value=t),u&&(u.textContent=o?`(${o})`:""),s){const n=s.getAttribute("data-action-template");if(n){const r=n.replace(":id",t);s.setAttribute("action",r)}else if(window.orderRoutes&&window.orderRoutes.updateStatus){const r=window.orderRoutes.updateStatus;s.setAttribute("action",r.includes(":id")?r.replace(":id",t):r.replace(/\/\d+$/,`/${t}`))}}if(!d)console.error("Elemen select #status tidak ditemukan di DOM modal.");else{if(d.options.length===0){const n=[{v:"pending",t:"Pending"},{v:"paid",t:"Paid"},{v:"processing",t:"Processing"},{v:"shipped",t:"Shipped"},{v:"complete",t:"Complete"},{v:"cancelled",t:"Cancelled"},{v:"return",t:"Return"}];d.innerHTML="",n.forEach(r=>{const i=document.createElement("option");i.value=r.v,i.textContent=r.t,d.appendChild(i)})}if(e){if(![...d.options].some(n=>n.value===e)){const n=document.createElement("option");n.value=e,n.textContent=e,n.selected=!0,d.appendChild(n)}d.value=e}else d.selectedIndex=0}new bootstrap.Modal(a).show()}catch(a){console.error("openChangeStatusModal error",a)}};document.addEventListener("DOMContentLoaded",function(){const t=document.getElementById("changeStatusModal");if(!t)return;let o=null;t.addEventListener("shown.bs.modal",function(){const e=document.getElementById("status");if(!e)return console.warn("status select not found on modal shown");try{if(window.Choices&&!e._choicesInstance){o=new Choices(e,{searchEnabled:!1,shouldSort:!1,itemSelectText:"",classNames:{containerOuter:"choices"}}),e._choicesInstance=o,console.log("Choices initialized for #status");return}}catch(a){console.warn("Choices init error:",a)}e.style.display="",e.classList.add("form-select")}),t.addEventListener("hidden.bs.modal",function(){const e=document.getElementById("status");try{e&&e._choicesInstance&&typeof e._choicesInstance.destroy=="function"&&(e._choicesInstance.destroy(),e._choicesInstance=null,console.log("Choices destroyed for #status"))}catch(a){console.warn("Choices destroy error:",a)}})});c(function(){if(!window.orderRoutes||!window.orderRoutes.index){console.error("orderRoutes.index not defined.");return}new f("#orders-table",{processing:!0,serverSide:!0,responsive:!0,autoWidth:!1,ajax:{url:window.orderRoutes.index,type:"GET",dataType:"json",cache:!1,error:function(t,o,e){console.error("DataTables AJAX error:",o,e,t.responseText),window.toast&&window.toast.error("Gagal memuat data order. Cek console.")}},columns:[{data:"DT_RowIndex",orderable:!1,searchable:!1},{data:"order_no",name:"order_no"},{data:"customer",orderable:!1},{data:"branch",orderable:!1},{data:"total_amount",name:"total_amount"},{data:"status",name:"status"},{data:"created_at",name:"created_at"},{data:"action",orderable:!1,searchable:!1}],order:[[6,"desc"]],drawCallback:function(){try{window.lucide&&typeof window.lucide.replace=="function"&&window.lucide.replace()}catch{}p(document.querySelector("#orders-table"))}}),c(document).on("click",".js-delete-order",function(t){t.preventDefault();const o=c(this).data("id"),e=c(this).data("name")||"";m({modalId:"deleteOrderModal",formId:"deleteOrderForm",itemNameId:"delete_order_title",id:o,name:e,route:window.orderRoutes.destroy})})});
