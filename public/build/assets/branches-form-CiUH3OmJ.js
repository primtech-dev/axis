import{$ as t}from"./jquery-DxCMfk7S.js";import{C as h}from"./choices-BgrVbzTe.js";import"./_commonjsHelpers-D6-XlEtG.js";import"./jquery-BQXThELV.js";function p(n=".choices-select",r={}){const e=document.querySelectorAll(n),o=[];if(e.length===0)return o;const c={searchEnabled:!0,searchPlaceholderValue:"Search...",itemSelectText:"",shouldSort:!1,removeItemButton:!1,noResultsText:"No results found",noChoicesText:"No choices to choose from",...r};return e.forEach(i=>{if(i.classList.contains("choices__input"))return;const s=new h(i,c);o.push(s)}),o}function a(n){window.toast&&typeof window.toast.error=="function"?window.toast.error(n):console.warn("Toast not available:",n)}function g(n){if(!n)return"";const r=n.toString().normalize("NFKD").replace(/[^\w\s-]/g,"").trim().replace(/\s+/g,"-").replace(/-+/g,"-").toUpperCase();return`${r.startsWith("KNC-")?"":"KNC-"}${r}`.substring(0,32)}function u(n){return n==null?!1:!isNaN(n)&&isFinite(n)}function d(n){if(!n)return!0;const r=n.trim();return/^[0-9+\-\s()]{4,20}$/.test(r)}t(function(){try{const e=document.querySelector('select[name="manager_admin_user_id"]');e&&p(e,{searchEnabled:!0,itemSelectText:"",shouldSort:!1,placeholderValue:"Pilih manager (opsional)",removeItems:!1,maxItemCount:1,allowHTML:!1})}catch(e){console.warn("Choices init failed:",e)}const n=t("#name"),r=t("#code");n.length&&r.length&&n.on("input",function(){const e=r.val();if(!e||e.trim()===""){const o=g(t(this).val());r.val(o)}}),t("#latitude, #longitude").on("blur",function(){const e=t(this).val().trim();e!==""&&(u(e)||(a("Latitude/Longitude harus berupa angka (contoh: -6.200000)."),t(this).val(""),t(this).focus()))}),t("#phone").on("blur",function(){const e=t(this).val().trim();e!==""&&(d(e)||(a("Format nomor telepon tidak valid. Gunakan angka dan simbol + - () jika perlu."),t(this).focus()))}),t("#branchForm").on("submit",function(e){const o=t("#code").val().trim(),c=t("#name").val().trim();if(!o)return e.preventDefault(),a("Kode cabang harus diisi."),t("#code").focus(),!1;if(!c)return e.preventDefault(),a("Nama cabang harus diisi."),t("#name").focus(),!1;const i=t("#latitude").val().trim(),s=t("#longitude").val().trim();if(i&&!u(i))return e.preventDefault(),a("Latitude harus berupa angka."),t("#latitude").focus(),!1;if(s&&!u(s))return e.preventDefault(),a("Longitude harus berupa angka."),t("#longitude").focus(),!1;const f=t("#phone").val().trim();if(f&&!d(f))return e.preventDefault(),a("Format nomor telepon tidak valid."),t("#phone").focus(),!1;const l=t(this).find('button[type="submit"]').first();l.prop("disabled",!0);const m=t(this).find('input[name="_method"][value="PUT"]').length>0?"Menyimpan perubahan...":"Membuat cabang...";return l.data("orig-html",l.html()),l.html(`<span class="spinner-border spinner-border-sm me-1" role="status" aria-hidden="true"></span> ${m}`),!0}),typeof window.serverValidationErrors<"u"&&Array.isArray(window.serverValidationErrors)&&window.serverValidationErrors.forEach(e=>a(e))});
